(this["webpackJsonpreact_redux-list-of-posts"]=this["webpackJsonpreact_redux-list-of-posts"]||[]).push([[0],{25:function(e,t,n){e.exports=n.p+"static/media/delete.d4a3dcc3.svg"},26:function(e,t,n){e.exports=n(41)},34:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(14),s=n.n(o),r=n(2),l=n(16),u=(n(34),"https://mate-api.herokuapp.com/"),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return fetch(u+e,t).then((function(e){if(!e.ok)throw new Error("".concat(e.status,": ").concat(e.statusText));return e.json()}))};var i=n(9),d=n.n(i),p=n(11),f=n(13),b=n(23),E=n(24),O=n(3),v={posts:[],post:null,selectedPostId:0,userId:0,users:[]},h=function(e){return{type:"SET_POSTID",value:e}},_=function(e){return e.userId},S=function(e){return{type:"SET_POSTS",posts:e}},j=function(e){return function(t){e?m("posts?userId=".concat(e)).then((function(e){t(S(e.data))})):m("posts?id=87&id=88&id=89&id=90&id=91&id=92&id=93").then((function(e){t(S(e.data))}))}},g={comments:null,commentsUpdated:!1},N=function(e){return{type:"SET_POST_COMMENTS",comments:e}},T=function(e){return{type:"SET_COMMENTS_UPDATED",commentsUpdated:e}},y=function(e){console.log("POST"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;console.log("add",1),m(e,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(t)})}("comments",e)},P=function(e){console.log("DELETE",e),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";m(e,{method:"DELETE"})}("comments/".concat(e))},I=function(e,t){return e?e.map((function(e){return e.id!==t.id?t:Object(O.a)({},e)})):null},w=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_LOADING":return!0;case"FINISH_LOADING":return!1;default:return e}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":return t.message;default:return e}},D=Object(f.combineReducers)({loading:w,message:C,postsState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERID":return Object(O.a)(Object(O.a)({},e),{},{userId:t.value});case"SET_USERS":return Object(O.a)(Object(O.a)({},e),{},{users:t.value});case"SET_POSTS":return Object(O.a)(Object(O.a)({},e),{},{posts:t.posts});case"SET_POST":return Object(O.a)(Object(O.a)({},e),{},{post:t.post});case"SET_POSTID":return Object(O.a)(Object(O.a)({},e),{},{selectedPostId:t.value});default:return e}},commentsState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POST_COMMENTS":return Object(O.a)(Object(O.a)({},e),{},{comments:t.comments});case"SET_NEW_COMMENT":return Object(O.a)(Object(O.a)({},e),{},{comments:I(e.comments,t.comment)});case"SET_COMMENTS_UPDATED":return Object(O.a)(Object(O.a)({},e),{},{commentsUpdated:t.commentsUpdated});default:return e}}}),U=function(e){return e.loading},k=function(e){return e.message},A=function(e){return e.postsState.users},L=function(e){return e.postsState.posts},x=function(e){return e.postsState.selectedPostId},M=function(e){return e.postsState.post},F=function(e){return e.commentsState.comments},R=function(e){return e.commentsState.commentsUpdated},G=Object(f.createStore)(D,Object(b.composeWithDevTools)(Object(f.applyMiddleware)(E.a))),J=n(4),W=function(){var e=Object(J.e)(),t=Object(J.d)(),n=new URLSearchParams(e.search),o=Object(r.c)(_),s=Object(r.c)(A),l=Object(r.b)(),u=Object(a.useCallback)((function(e){Number(e)>0?(n.set("userId",e),l(function(e){return{type:"SET_USERID",value:e}}(Number(e)))):n.delete("userId"),t.push({search:n.toString()})}),[t,n,l]);return s?c.a.createElement("label",null,"Select a user: \xa0",c.a.createElement("select",{name:"user",className:"App__user-selector",value:o,onChange:function(e){u(e.target.value)}},c.a.createElement("option",{value:""},"Choose a user"),s.map((function(e){return c.a.createElement("option",{value:e.id,key:e.id},e.name)})))):c.a.createElement("div",{className:"App__loading-message"},"Loading data...")},H=(n(38),function(){var e=Object(r.c)(L),t=Object(r.c)(x),n=Object(J.e)(),o=new URLSearchParams(n.search),s=Number(o.get("userId"))||0,l=Object(r.b)();Object(a.useEffect)((function(){s>0?(console.log("userId and selectedUserId in useEffect 1",s),l(j(s))):(console.log("userId and selectedUserId in useEffect 2",s),l(j()))}),[s,l]);var u=!e||!e.length;return c.a.createElement("div",{className:"PostsList"},u?c.a.createElement("p",{className:"info"},"Posts list is empty."):c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,"Posts:"),c.a.createElement("ul",{className:"PostsList__list"},e.map((function(e){return c.a.createElement("li",{className:"PostsList__item",key:e.id},c.a.createElement("div",null,c.a.createElement("b",null,"[User",e.title,"]:"," "),e.body),t!==e.id?c.a.createElement("button",{type:"button",className:"PostsList__button button",onClick:function(){l(h(e.id))}},"Open"):c.a.createElement("button",{type:"button",className:"PostsList__button button button--active",onClick:function(){l(h(0)),l(N(null))}},"Close"))})))))}),Y=n(18),B=n(25),q=n.n(B),z=c.a.memo((function(e){var t=e.postId,n=Object(r.c)(F),o=Object(r.c)(R),s=Object(r.b)();Object(a.useEffect)((function(){t>0&&(s(function(e){return function(t){console.log(e),m("comments?postId=".concat(e)).then((function(e){t(N(e.data))}))}}(t)),console.log("Comments useeffect postId",t,o)),o&&(console.log("Comments commentsUpdated is true in useeffect",t,o),s(T(!1)))}),[t,o,s]);var l=function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:s(T(!0));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n&&n.length?(console.log(n),c.a.createElement("ul",{className:"PostDetails__list"},n.map((function(e){return c.a.createElement("li",{className:"PostDetails__list-item",key:e.id},c.a.createElement("button",{type:"button",className:"PostDetails__remove-button button",onClick:function(){e.id&&l(e.id)}},c.a.createElement("img",{src:q.a,alt:"delete icon"})),c.a.createElement("p",null,e.body," ",c.a.createElement("sub",null,e.id," post ",t)))})))):c.a.createElement("p",{className:"info"},"No comments")})),K=n(17),Q=(n(39),c.a.memo((function(e){var t=e.postId,n={name:"",email:"",body:"",postId:t},o=Object(a.useState)(n),s=Object(Y.a)(o,2),l=s[0],u=s[1],m=Object(r.b)();Object(a.useEffect)((function(){u(n)}),[t]);var i=function(e){var t=e.target,n=t.name,a=t.value;u((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(K.a)({},n,a))}))},f=function(){!0===function(e){var t=!0;return e.name.length||(t=!1),t}(l)?(b(l),u(n),u({name:"",email:"",body:"",postId:t})):console.log("Write message")},b=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now().toString(),a=Object(O.a)(Object(O.a)({},t),{},{id:Number(n.substr(n.length-6))}),console.log("new comment is ",a),e.next=5,y(a);case 5:m(T(!0));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("form",{className:"NewCommentForm",onSubmit:function(e){e.preventDefault(),f()},method:"POST"},c.a.createElement("div",{className:"form-field"},c.a.createElement("input",{type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:l.name,onChange:i})),c.a.createElement("div",{className:"form-field"},c.a.createElement("input",{type:"text",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:l.email,onChange:i})),c.a.createElement("div",{className:"form-field"},c.a.createElement("textarea",{name:"body",placeholder:"Type comments here",className:"NewCommentForm__input",value:l.body,onChange:i})),c.a.createElement("button",{type:"submit",className:"NewCommentForm__submit-button button"},"Add a comment"))}))),V=(n(40),function(){var e=Object(a.useState)(!1),t=Object(Y.a)(e,2),n=t[0],o=t[1],s=Object(r.c)(x),l=Object(r.c)(M),u=Object(r.c)(F),i=Object(r.b)();Object(a.useEffect)((function(){var e;s>0&&i((e=s,function(t){m("posts/".concat(e)).then((function(e){t({type:"SET_POST",post:e.data})}))}))}),[s,i]);var d=l||{},p=u&&u.length;return c.a.createElement("section",{className:"PostDetails"},s?c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,d.title),c.a.createElement("div",{className:"PostDetails__post"},c.a.createElement("p",null,d.body)),c.a.createElement("div",{className:"PostDetails__comments"},!!p&&c.a.createElement("button",{type:"button",className:"button",onClick:function(){o(!n)}},n?"Show ":"Hide ","comments"),!n&&c.a.createElement(z,{postId:s}),c.a.createElement("div",{className:"PostDetails__form-wrapper"},c.a.createElement(Q,{postId:s})))):c.a.createElement("p",{className:"info"},"No post details"))}),X=function(){var e=Object(r.c)(U),t=Object(r.c)(k)||"Ready!",n=Object(r.b)();return Object(a.useEffect)((function(){(console.log("".concat(u,"/users")),m("users")).then((function(e){return n({type:"SET_USERS",value:e.data})}))}),[n]),c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App__header"},c.a.createElement(W,null)),c.a.createElement("main",{className:"App__main"},c.a.createElement("div",{className:"App__sidebar"},c.a.createElement(H,null)),c.a.createElement("div",{className:"App__content"},c.a.createElement(V,null))),e?c.a.createElement("div",{className:"alert"},"'Loading...'"):c.a.createElement("div",{className:"alert alert--fade-out"},t))},Z=function(){return c.a.createElement(r.a,{store:G},c.a.createElement(l.a,null,c.a.createElement(X,null)))};s.a.render(c.a.createElement(Z,null),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.5780ef24.chunk.js.map